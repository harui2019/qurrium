[project]
name = "qurry"
version = "0.6.5.dev2"
authors = [{ name = "Huai-Chung Chang", email = "harui2019@proton.me" }]
description = "Qurry 🍛 - The Measuring Tool for Renyi Entropy, Loschmidt Echo, and Magnetization Squared, The Library of Some Common Cases"
readme = "README.md"
requires-python = ">=3.9"
classifiers = [
    "Operating System :: MacOS",
    "Operating System :: POSIX :: Linux",

    "Programming Language :: Python :: 3 :: Only",
    'Programming Language :: Python :: 3.9',
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",

    "Programming Language :: Python :: Implementation :: CPython",
]

[project.urls]
"Homepage" = "https://github.com/harui2019/qurry"
"Bug Tracker" = "https://github.com/harui2019/qurry/issues"

[build-system]
requires = ["pytest", "cython", "setuptools", "setuptools-rust", "wheel"]
build-backend = "setuptools.build_meta"

# If you find some configurations are similar to what qiskit does,
# yes, it does. I 'learned' from them.

[tool.cibuildwheel]
skip = [
    # "pp*",
    "*-musllinux_i686", # rust tier 2 support
    "cp312-*",          # For some reason, it fails to build
    "*-manylinux_i686",
]
before-all = [
    'python -c "print(\"=\"*70)"',
    'python -c "print(\"### Building \".ljust(70, \".\"))"',
    'python -c "print(\"=\"*70)"',
]
before-test = [
    'python -c "print(\"=\"*70)"',
    'python -c "print(\"### Testing \".ljust(70, \".\"))"',
    'python -c "print(\"=\"*70)"',
    "pip install pytest",
]
test-command = ["pytest {project}"]

[tool.cibuildwheel.linux]
environment = { PATH = "$HOME/.cargo/bin:$PATH" }
before-all = [
    "curl https://sh.rustup.rs -sSf | sh -s -- --default-toolchain=nightly --profile=minimal -y",
    'source "$HOME/.cargo/env"',
    "rustup show",
]

[tool.cibuildwheel.macos]
before-all = ["rustup show"]
